= Cluster Application Migration Workload - OCP 4

== Overview

The workload includes migration operator which deploys OADP Operator and lab instructions to deploy Velero.

Current workload deploys OADP 0.3.0

=== Deploy the workload
[source,'bash']
----
ansible-playbook -i "bastion.${GUID}.${BASE_DOMAIN}", ./ansible/configs/ocp-workloads/ocp-workload.yml \
-e"ansible_user=${ANSIBLE_USER}" \
-e"ocp_workload=ocp4-workload-oadp" \
-e"ocs_migstorage=false" \
-e"silent=False" \
-e"ACTION=create"
----
=== Deploy the workload with OCS
[source,'bash']
----
OCS_NAMESPACE=oadp-storage-1
OCS_MCG_PV_POOL_BUCKET_NAME=oadp-storage-1
ansible-playbook -i "bastion.${GUID}.${BASE_DOMAIN}", ./ansible/configs/ocp-workloads/ocp-workload.yml \
-e"ansible_user=${ANSIBLE_USER}" \
-e"ocp_workload=ocp4-workload-ocs-poc" \
-e"silent=False" \
-e"ocs_namespace=${OCS_NAMESPACE}" \
-e"ocs_mcg_pv_pool_bucket_name=${OCS_MCG_PV_POOL_BUCKET_NAME}" \
-e"ACTION=create"
ansible-playbook -i "bastion.${GUID}.${BASE_DOMAIN}", ./ansible/configs/ocp-workloads/ocp-workload.yml \
-e"ansible_user=${ANSIBLE_USER}" \
-e"ocp_workload=ocp4-workload-oadp" \
-e"ocs_migstorage=true" \
-e"ocs_namespace=${OCS_NAMESPACE}" \
-e"ocs_bucketname=${OCS_MCG_PV_POOL_BUCKET_NAME}" \
-e"silent=False" \
-e"ACTION=create"
----

=== Delete the workload

[source,'bash']
----
ansible-playbook -i "bastion.${GUID}.${BASE_DOMAIN}", ./ansible/configs/ocp-workloads/ocp-workload.yml \
-e"ansible_user=${ANSIBLE_USER}" \
-e"ocp_workload=ocp4-workload-oadp" \
-e"silent=False" \
-e"ACTION=delete" \
----

=== Delete the workload with OCS
[source,'bash']
----
OCS_NAMESPACE=oadp-storage
OCS_MCG_PV_POOL_BUCKET_NAME=oadp-storage
ansible-playbook -i "bastion.${GUID}.${BASE_DOMAIN}", ./ansible/configs/ocp-workloads/ocp-workload.yml \
-e"ansible_user=${ANSIBLE_USER}" \
-e"ocp_workload=ocp4-workload-ocs-poc" \
-e"silent=False" \
-e"ocs_namespace=${OCS_NAMESPACE}" \
-e"ocs_mcg_pv_pool_bucket_name=${OCS_MCG_PV_POOL_BUCKET_NAME}" \
-e"ACTION=delete"
ansible-playbook -i "bastion.${GUID}.${BASE_DOMAIN}", ./ansible/configs/ocp-workloads/ocp-workload.yml \
-e"ansible_user=${ANSIBLE_USER}" \
-e"ocp_workload=ocp4-workload-oadp" \
-e"ocs_migstorage=true" \
-e"ocs_namespace=${OCS_NAMESPACE}" \
-e"ocs_bucketname=${OCS_MCG_PV_POOL_BUCKET_NAME}" \
-e"silent=False" \
-e"ACTION=delete"
----